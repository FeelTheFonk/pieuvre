// Pieuvre — Composant Progress Bar
//
// Barre de progression animée.

import { Tokens } from "../tokens.slint";

export component ProgressBar inherits Rectangle {
    in property <float> value: 0.0; // 0.0 à 1.0
    in property <bool> indeterminate: false;
    in property <color> bar-color: Tokens.primary-color;
    
    height: 8px;
    border-radius: 4px;
    background: Tokens.surface-color;
    clip: true;
    
    // Fill
    Rectangle {
        x: indeterminate ? (parent.width * animation-tick() / 1s * 0.5) - self.width : 0;
        width: indeterminate ? parent.width * 0.3 : parent.width * value;
        height: 100%;
        border-radius: 4px;
        background: bar-color;
        
        animate width { duration: Tokens.anim-normal; easing: ease-out; }
    }
}

// Progress bar avec label
export component LabeledProgressBar inherits Rectangle {
    in property <string> label: "Progress";
    in property <float> value: 0.0;
    in property <bool> show-percentage: true;
    
    height: 48px;
    background: transparent;
    
    VerticalLayout {
        spacing: Tokens.spacing-xs;
        
        HorizontalLayout {
            alignment: space-between;
            
            Text {
                text: label;
                color: Tokens.text-primary;
                font-size: Tokens.font-size-md;
            }
            
            if show-percentage: Text {
                text: round(value * 100) + "%";
                color: Tokens.text-secondary;
                font-size: Tokens.font-size-sm;
            }
        }
        
        ProgressBar {
            value: root.value;
        }
    }
}
